FROM onosproject/onos:latest

# RUN : \
#     && rm -rf /etc/apt/sources.list.d/zulu.list \ 
#     && apt-get update \
#     && apt-get -y install curl vim tree git wget maven \
#     && printf "\nexport ONOS_ROOT=\"/root/onos\"\nexport PATH=\$PATH:/root/onos/bin\n" >> /root/.bashrc \
#     # && cd /root/init-app \
#     # && mvn clean install -Dmaven.test.skip=true \
#     && :

# RUN : \
#     && apt-get update \
#     && apt-get -y install curl \
#     && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \
#         software-properties-common \
#     && add-apt-repository -y ppa:deadsnakes \
#     && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \
#         python3.8-venv \
#     && apt-get clean \
#     && rm -rf /var/lib/apt/lists/* \
#     && :

RUN apt-get update \
    && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \
        python3.8-venv \
    && :

RUN apt-get update \
    && apt-get install -y python3-venv \
    && python3.8 -m venv /venv \
    && rm -rf /var/lib/apt/lists/*


RUN python3.8 -m venv /venv
ENV PATH=/venv/bin:$PATH

RUN : \
    && pip install redis \
    && :

ADD . /dynamicACL/

# Run ONOS
ENV ONOS_APPS="drivers,openflow,lldpprovider,proxyarp,gui2"
ENTRYPOINT ["./bin/onos-service"]
CMD ["server"]
